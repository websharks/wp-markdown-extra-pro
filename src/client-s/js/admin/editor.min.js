"use strict";var WpMarkdownExtraEditor;!function(e){var t=jQuery,s=function(){function e(e){this.ed=e}return e.prototype.format=function(e){var s=this;if(/\[gallery\s/i.test(e))return e;if(!/<img\s.*?src=['"]([^'"]+)/i.test(e))return e;var i="";return t.each(e.split(/[\r\n]+/),function(e,t){var n,r,a,o,l,h;(n=/<img\s.*?src=['"]([^'"]+)/i.exec(t))&&(r=/<a\s.*?href=['"]([^'"]+)/i.exec(t),a=/<img\s.*?alt=['"]([^'"]+)/i.exec(t),o=/<img\s.*?class=['"]([^'"]+)/i.exec(t),l=/\[caption\s.*?align=['"]([^'"]+)/i.exec(t),h=/(?:<img|\[caption)\s.*?width=['"]([^'"]+)/i.exec(t),r&&(r[1]=r[1].replace(/^https?:\/{2}/i,"//")),n[1]=n[1].replace(/^https?:\/{2}/i,"//"),o=!o&&l?l:o,o&&/alignnone/i.test(o[1])&&(o=null),i+="\n","html"===s.ed.data.settings.mediaInserts?(r&&(i+='<a href="'+_.escape(r[1])+'">'),i+='<img src="'+_.escape(n[1])+'"',a&&(i+=' alt="'+_.escape(a[1])+'"'),o&&/alignleft/i.test(o[1])?i+=' class="alignleft"':o&&/aligncenter/i.test(o[1])?i+=' class="aligncenter"':o&&/alignright/i.test(o[1])&&(i+=' class="alignright"'),h&&(i+=' width="'+_.escape(h[1])+'"'),i+=" />",r&&(i+="</a>")):(r&&(i+="["),i+="![",a&&(i+=a[1].replace(/\[/g,"(").replace(/\]/g,")")),i+="](",i+=n[1].replace(/\(/g,"[").replace(/\)/g,"]"),i+=")",(o||h)&&(i+="{"),o&&(/alignleft/i.test(o[1])?i+=".alignleft":/aligncenter/i.test(o[1])?i+=".aligncenter":/alignright/i.test(o[1])&&(i+=".alignright")),o&&h?i+=" width="+_.escape(h[1]):h&&(i+="width="+_.escape(h[1])),(o||h)&&(i+="}"),r&&(i+="](",i+=r[1].replace(/\(/g,"[").replace(/\)/g,"]"),i+=")")))}),i+"\n"},e}();e.MediaHtml=s}(WpMarkdownExtraEditor||(WpMarkdownExtraEditor={}));var WpMarkdownExtraEditor;!function(e){var t=jQuery,s=function(){function s(){var s=this;this.data=wpMarkdownExtraEditorData,this.cns=this.data.brand.slug+"-editor",this.ens="."+this.data.brand.slug+"-editor",this.mediaHtml=new e.MediaHtml(this),this.initChain=t.Deferred().resolve().promise(),this.setupChain=t.Deferred().resolve().promise(),t(document).ready(function(){return s.onDomReady()})}return s.prototype.onDomReady=function(){this.$textarea=t("."+this.cns+"-textarea"),this.$textarea.length&&this.init()},s.prototype.init=function(){var e=this;this.initChain.then(function(){return e.initClasses()}).then(function(){return e.initElements()}).then(function(){return e.initIde()}).then(function(){return e.initPreview()}).then(function(){return e.initComplete()}).then(function(){return e.setup()})},s.prototype.initClasses=function(){this.themeClass=this.cns+"-"+this.data.settings.theme+"-theme",this.previewClass=this.cns+"-preview-mode",this.fullscreenClass=this.cns+"-fullscreen-mode",this.fullscreenPreviewClass=this.cns+"-fullscreen-preview-mode",this.fullscreenSplitPreviewClass=this.cns+"-fullscreen-split-preview-mode"},s.prototype.initElements=function(){this.$win=t(window),this.$doc=t(document),this.$html=t("html"),this.$body=t("body"),this.$html.addClass(this.themeClass),this.data.settings.ideEnable&&this.$html.addClass(this.cns+"-has-ide"),this.$form=this.$textarea.closest("form#post"),this.$form.addClass(this.cns+"-form"),this.$area=this.$form.find("#postdivrich"),this.$area.addClass(this.cns+"-area"),this.$wrapper=this.$area.find("#wp-content-wrap"),this.$wrapper.addClass(this.cns+"-wrapper"),this.$toolbar=this.$area.find("#wp-content-editor-tools"),this.$toolbarBtns=t('<div class="'+_.escape(this.cns+"-toolbar-btns")+'"></div>'),this.$toolbar.css({visibility:"hidden"}),this.$toolbar.find(".wp-editor-tabs").hide(),this.$toolbar.addClass(this.cns+"-toolbar").append(this.$toolbarBtns),this.$container=this.$area.find("#wp-content-editor-container"),this.$container.css({visibility:"hidden"}),this.$container.addClass(this.cns+"-container"),this.data.settings.ideEnable&&(this.$ide=t('<textarea class="'+_.escape(this.cns+"-ide")+'"></textarea>'),this.$textarea.before(this.$ide)),this.$statusInfo=this.$area.find("#post-status-info"),this.$statusInfo.css({visibility:"hidden"}),this.$statusInfo.addClass(this.cns+"-status-info"),this.$textareaResizeHandle=this.$area.find("#content-resize-handle"),this.$textareaResizeHandle.hide(),this.$preview=t('<iframe class="'+_.escape(this.cns+"-preview")+'" src="'+_.escape(this.data.settings.previewUrl)+'"></iframe>'),this.$loadingStyles=this.$area.find("."+this.cns+"-loading-styles"),this.$loading=this.$area.find("."+this.cns+"-loading")},s.prototype.initIde=function(){this.data.settings.ideEnable&&(this.ide=ace.edit(this.$ide[0]),"Infinity"===this.data.settings.ide.maxLines&&(this.data.settings.ide.maxLines=1/0),this.ide.setOptions(this.data.settings.ide),this.ide.setStyle(this.cns+"-ide"),this.ide.$blockScrolling=1/0,this.docValue(this.$textarea.val()),this.$textarea.addClass("-position-offscreen"),this.$ide=this.$container.find("."+this.cns+"-ide"))},s.prototype.initPreview=function(){var e=this,s=t.Deferred(function(s){e.$preview.on("load"+e.ens,function(){var i=e.$preview[0];e.$previewWindow=t(i.contentWindow||document.defaultView),e.$previewDocument=t(i.contentDocument||i.contentWindow.document),e.$previewHtml=e.$previewDocument.find("html"),e.$previewBody=e.$previewDocument.find("body"),e.$previewDiv=e.$previewBody.find("#md-preview-div");var n=e.$previewHtml,r=e.$previewBody;if(e.data.settings.hljsStyleUrl){var a=e.data.settings.hljsStyleUrl,o=e.data.settings.hljsStyleSri?' integrity="'+_.escape(e.data.settings.hljsStyleSri)+'" crossorigin="anonymous"':"";r.append('<link type="text/css" rel="stylesheet" href="'+_.escape(a)+'"'+o+" />")}if(e.data.settings.previewStylesUrl){var a=e.data.settings.previewStylesUrl,o=e.data.settings.previewStylesSri?' integrity="'+_.escape(e.data.settings.previewStylesSri)+'" crossorigin="anonymous"':"";r.append('<link type="text/css" rel="stylesheet" href="'+_.escape(a)+'"'+o+" />")}if(e.data.settings.hljsBgColor){var l=e.data.settings.hljsBgColor;r.append("<style>.hljs-pre > .hljs { background: "+l.replace(/[<&>]/g,"")+" !important; }</style>")}if(e.data.settings.hljsFontFamily){var h=e.data.settings.hljsFontFamily;r.append("<style>.hljs-pre > .hljs { font-family: "+h.replace(/[<&>]/g,"")+" !important; }</style>")}if(e.data.settings.customPreviewStyles){var c=e.data.settings.customPreviewStyles;r.append("<style>"+c+"</style>")}if(e.data.settings.previewTypekitId){var p=e.data.settings.previewTypekitId,d=t("<script></script>");n.addClass("wf-loading"),r.append(d),d.attr("src","//use.typekit.net/"+encodeURIComponent(p)+".js")}if(e.data.settings.customPreviewScripts){var u=e.data.settings.customPreviewScripts;r.append("<script>"+u+"</script>")}s.resolve()}),e.$container.append(e.$preview)});return s.promise()},s.prototype.initComplete=function(){this.$area.trigger("initComplete"+this.ens)},s.prototype.setup=function(){var e=this;this.setupChain.then(function(){return e.setupTextarea()}).then(function(){return e.setupIde()}).then(function(){return e.setupContainer()}).then(function(){return e.setupMediaBtn()}).then(function(){return e.setupToolbar()}).then(function(){return e.setupComplete()})},s.prototype.setupTextarea=function(){var e=this;if(!this.data.settings.ideEnable){this.scrollLockingEnable(),this.$textarea.css({"font-size":this.data.settings.fontSize,"font-family":this.data.settings.fontFamily});var t="php"===this.data.settings.previewMethod?1e3:250,s=_.debounce(function(){return e.previewRender()},t);this.$textarea.on("keyup"+this.ens,function(t){e.automaticScrollExpand(t)}),this.$textarea.on("cut"+this.ens+" paste"+this.ens+" keyup"+this.ens+" change"+this.ens,s)}},s.prototype.setupIde=function(){var e=this;if(this.data.settings.ideEnable){this.scrollLockingEnable();var s=_.debounce(function(){e.$textarea.val(e.docValue()),e.$textarea.trigger("input","ide-update"+e.ens)},1e3),i="php"===this.data.settings.previewMethod?1e3:250,n=_.debounce(function(){return e.previewRender()},i);this.ide.session.on("change",s),this.ide.session.on("change",n),this.$textarea.on("input"+this.ens,function(t,s){s!=="ide-update"+e.ens&&(e.ide.focus(),e.docValue(e.$textarea.val()))}),t("#post-preview").on("click"+this.ens,function(){return e.$textarea.val(e.docValue())}),this.$form.on("submit"+this.ens,function(){return e.$textarea.val(e.docValue())})}},s.prototype.setupContainer=function(){var e=this,s=250,i=_.debounce(function(t){return e.adjustContainer(t)},s);t(window).on("resize"+this.ens,i)},s.prototype.setupMediaBtn=function(){var e=this,t=window.send_to_editor;window.send_to_editor=function(s){return window.wpActiveEditor&&"content"!==wpActiveEditor?t(s):(s=e.mediaHtml.format(s),void(e.ide?e.ide.insert(s):t(s)))}},s.prototype.setupToolbar=function(){var e=this;this.$previewBtn=t('<button type="button" class="-preview button" title="'+_.escape(this.data.i18n.preview+" "+this.data.i18n.toggle)+'"><span class="-icon sharkicon sharkicon-eye"></span></button>'),this.$fullscreenSplitPreviewBtn=t('<button type="button" class="-fullscreen-split button" title="'+_.escape(this.data.i18n.fullscreenSplitPreview+" "+this.data.i18n.toggle)+'"><span class="-icon sharkicon sharkicon-columns"></span></button>'),this.$sitePreviewBtn=t('<button type="button" class="-post-preview button" title="'+_.escape(this.data.i18n.sitePreview)+'"><span class="-icon sharkicon sharkicon-octi-link-external"></span></button>'),this.$fullscreenBtn=t('<button type="button" class="-fullscreen button" title="'+_.escape(this.data.i18n.fullscreen+" "+this.data.i18n.toggle)+'"><span class="-icon sharkicon sharkicon-octi-screen-full"></span></button>'),this.$saveDraftBtn=t('<button type="button" class="-save-draft button" title="'+_.escape(this.data.i18n.saveDraft)+'"><span class="-icon sharkicon sharkicon-floppy-o"></span></button>'),this.$publishBtn=t('<button type="button" class="-publish button" title="'+_.escape(this.data.i18n.publish)+'"><span class="-icon sharkicon sharkicon-thumb-tack"></span></button>'),this.$updateBtn=t('<button type="button" class="-update button" title="'+_.escape(this.data.i18n.update)+'"><span class="-icon sharkicon sharkicon-thumb-tack"></span></button>'),this.$trashBtn=t('<button type="button" class="-trash button" title="'+_.escape(this.data.i18n.trash)+'"><span class="-icon sharkicon sharkicon-trash"></span></button>');var s=t("#preview-action:visible > #post-preview:visible"),i=t("#save-action:visible > #save-post:visible"),n=t("#publishing-action:visible > #publish:visible"),r=t("#delete-action:visible > a:visible");this.$toolbarBtns.append(this.$previewBtn),this.$toolbarBtns.append(this.$fullscreenSplitPreviewBtn),s.length&&this.$toolbarBtns.append(this.$sitePreviewBtn),i.length&&this.$toolbarBtns.append(this.$saveDraftBtn),n.length&&(this.data.settings.postId?this.$toolbarBtns.append(this.$updateBtn):this.$toolbarBtns.append(this.$publishBtn)),r.length&&this.$toolbarBtns.append(this.$trashBtn),this.$toolbarBtns.append(this.$fullscreenBtn),this.$previewBtn.on("click"+this.ens,function(t){switch(t.stopImmediatePropagation(),t.preventDefault(),e.currentMode){case"default":e.preparePreviewMode();break;case"preview":e.prepareDefaultMode();break;case"fullscreen":e.prepareFullscreenPreviewMode();break;case"fullscreen-preview":e.prepareFullscreenMode();break;case"fullscreen-split-preview":e.prepareFullscreenPreviewMode();break;default:e.prepareDefaultMode()}}),this.$fullscreenSplitPreviewBtn.on("click"+this.ens,function(t){switch(t.stopImmediatePropagation(),t.preventDefault(),e.currentMode){case"default":e.prepareFullscreenSplitPreviewMode();break;case"preview":e.prepareFullscreenSplitPreviewMode();break;case"fullscreen":e.prepareFullscreenSplitPreviewMode();break;case"fullscreen-preview":e.prepareFullscreenSplitPreviewMode();break;case"fullscreen-split-preview":e.prepareFullscreenMode();break;default:e.prepareDefaultMode()}}),this.$fullscreenBtn.on("click"+this.ens,function(t){switch(t.stopImmediatePropagation(),t.preventDefault(),e.currentMode){case"default":e.prepareFullscreenMode();break;case"preview":e.prepareFullscreenPreviewMode();break;case"fullscreen":e.prepareDefaultMode();break;case"fullscreen-preview":e.prepareDefaultMode();break;case"fullscreen-split-preview":e.prepareDefaultMode();break;default:e.prepareDefaultMode()}}),this.$sitePreviewBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),s.click()}),this.$saveDraftBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),i.click()}),this.$publishBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),n.click()}),this.$updateBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),n.click()}),this.$trashBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),location.href=r.attr("href")})},s.prototype.setupComplete=function(){var e=this;this.$loading.fadeOut(200,function(){e.$loading.remove(),e.$loadingStyles.remove(),delete e.initChain,delete e.setupChain,e.$toolbar.css({visibility:""}),e.$container.css({visibility:""}),e.$statusInfo.css({visibility:""}),e.prepareDefaultMode(),e.$area.trigger("setupComplete"+e.ens)})},s.prototype.docValue=function(e){return void 0!==e?this.ide?this.ide.setValue(e,-1):this.$textarea.val(e):e=this.ide?this.ide.getValue():this.$textarea.val(),t.trim(e.replace(/(?:\r\n|\r)/g,"\n"))},s.prototype.fullscreenBodyOverflow=function(e){e===!1?this.$body.css({overflow:"hidden",width:"calc(100% - "+this.scrollbarWidth+"px)"}):this.$body.css({overflow:"",width:""})},s.prototype.adjustContainer=function(e){if(this.currentMode.indexOf("fullscreen")!==-1){var t=this.$toolbar.outerHeight();this.$container.css({"max-height":"calc(100% - "+t+"px)"})}else this.$container.css({"max-height":""});!this.ide||e&&"resize"===e.type||this.ide.resize(!0)},s.prototype.prepareDefaultMode=function(){this.$html.removeClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.hide(),this.$saveDraftBtn.hide(),this.$publishBtn.hide(),this.$updateBtn.hide(),this.$trashBtn.hide(),this.$previewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-eye"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-normal").addClass("sharkicon-octi-screen-full"),this.currentMode="default",this.fullscreenBodyOverflow(),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender("")},s.prototype.preparePreviewMode=function(){this.$html.addClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.hide(),this.$saveDraftBtn.hide(),this.$publishBtn.hide(),this.$updateBtn.hide(),this.$trashBtn.hide(),this.$previewBtn.find(".-icon").removeClass("sharkicon-eye").addClass("sharkicon-pencil"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-normal").addClass("sharkicon-octi-screen-full"),this.currentMode="preview",this.fullscreenBodyOverflow(),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender(this.docValue())},s.prototype.prepareFullscreenPreviewMode=function(){this.$html.removeClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.addClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.show(),this.$saveDraftBtn.show(),this.$publishBtn.show(),this.$updateBtn.show(),this.$trashBtn.show(),this.$previewBtn.find(".-icon").removeClass("sharkicon-eye").addClass("sharkicon-pencil"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-full").addClass("sharkicon-octi-screen-normal"),this.currentMode="fullscreen-preview",this.fullscreenBodyOverflow(!1),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender(this.docValue())},s.prototype.prepareFullscreenSplitPreviewMode=function(){this.$html.removeClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.addClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.show(),this.$saveDraftBtn.show(),this.$publishBtn.show(),this.$updateBtn.show(),this.$trashBtn.show(),this.$previewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-eye"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-columns").addClass("sharkicon-pencil"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-full").addClass("sharkicon-octi-screen-normal"),this.currentMode="fullscreen-split-preview",this.fullscreenBodyOverflow(!1),this.adjustContainer(),this.previewScrollSyncEnable(),this.previewRender(this.docValue())},s.prototype.prepareFullscreenMode=function(){this.$html.removeClass(this.previewClass),this.$html.addClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.show(),this.$saveDraftBtn.show(),this.$publishBtn.show(),this.$updateBtn.show(),this.$trashBtn.show(),this.$previewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-eye"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-full").addClass("sharkicon-octi-screen-normal"),this.currentMode="fullscreen",this.fullscreenBodyOverflow(!1),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender("")},s.prototype.previewRender=function(e){var s=this;if(""===e)return this.$previewDiv.html("");if(this.$preview.is(":visible")){if(void 0===e&&(e=this.docValue()),!e)return this.$previewDiv.html("");if(this.data.settings.previewTypekitId&&!this.previewTypekitLoaded&&(this.previewTypekitLoaded=!0,this.$previewWindow[0].Typekit.load({async:!0})),"php"===this.data.settings.previewMethod)this.previewXhr&&this.previewXhr.abort(),this.previewXhr=t.ajax({type:"POST",processData:!1,data:pako.deflate(e),headers:{"content-encoding":"gzip"},contentType:"application/octet-stream",url:this.data.settings.ajaxRestActionPreviewUrl,success:function(e){var i=e.html,n=t("<div>"+i+"</div>");s.hljsInHtmlNode(n),s.$previewDiv.html(n.html())},error:function(e){return s.log("error",e)}});else{this.mdIt||(this.mdIt=markdownit({html:!0,xhtmlOut:!0,breaks:!0,linkify:!1,quotes:"“”‘’",typographer:!0,langPrefix:"lang-",highlight:this.mdItTransformHljs}).use(markdownItAttrs).use(markdownitDeflist).use(markdownitAbbr).use(markdownitFootnote),this.mdIt.renderer.rules.heading_open=function(e,t,s,i,n){var r=e[t],a=e[t+1],o=a.children.reduce(function(e,t){return e+t.content},""),l=o.toLowerCase();return l=l.replace(/[^\w]+/g,"-"),l="j2h."+l.replace(/(?:^[\s\-]+|[\s\-]+$)/g,""),r.attrs=r.attrs||[],r.attrs.push(["id",l]),n.renderToken.apply(n,arguments)},this.mdIt.renderer.rules.code_block=function(e,s,i,n,r){var a=e[s],o=t.trim(a.info||"").split(/\s+/g)[0],l=r.renderAttrs(a);return i.highlight(a.content,o,l)},this.mdIt.renderer.rules.fence=this.mdIt.renderer.rules.code_block);var i=this.mdIt.render(e);this.$previewDiv.html(i)}}},s.prototype.hljsInHtmlNode=function(e){var s=".no-hljs, .no-highlight, .nohighlight",i=".lang-none, .lang-plain, .lang-text, .lang-txt, .none, .plain, .text, .txt";e.find("pre > code").not(s).each(function(e,s){var n=t(s),r=n.parent();r.addClass("hljs-pre"),n.is(i)?n.addClass("hljs lang-none"):hljs.highlightBlock(s)})},s.prototype.mdItTransformHljs=function(e,s,i){var n=' class="hljs-pre code"',r=i||"";return s=s||"none",r=/\sclass\="([^"]*)"/i.test(r)?r.replace(/\sclass\="([^"]*)"/i,function(e,t){return' class="hljs lang-'+_.escape(s)+t+'"'}):' class="hljs lang-'+_.escape(s)+'"'+r,/\stitle\="([^"]*)"/i.test(r)&&(r=r.replace(/\stitle\="([^"]*)"/i,function(e,t){return n+=' title="'+t+'"',""})),e&&t.inArray(s,["none","plain","text","txt"])===-1&&(e=hljs.highlightAuto(e,[s]).value),"<pre"+n+"><code"+r+">"+e+"</code></pre>"},s.prototype.scrollLockingEnable=function(){var e=this;if(this.scrollLockingDisable(),this.ide){var t=this.$ide.find("> .ace_scrollbar-v"),s=this.$ide.find("> .ace_scroller > .ace_content");this.scrollLockHandler=function(s){var i=s.originalEvent.deltaY,n=i<0?"up":"down",r=t.prop("scrollHeight"),a=t.innerHeight(),o=t.scrollTop();r-a<=0||("up"===n&&o+i<=0||"down"===n&&o+i>=r-a)&&(s.preventDefault(),s.stopImmediatePropagation(),e.ide.session.setScrollTop(o+i))},s.on("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)}else{var i=this.$textarea;this.scrollLockHandler=function(e){var t=e.originalEvent.deltaY,s=t<0?"up":"down",n=i.prop("scrollHeight"),r=i.innerHeight(),a=i.scrollTop();n-r<=0||("up"===s&&a+t<=0||"down"===s&&a+t>=n-r)&&(e.preventDefault(),e.stopImmediatePropagation(),i.scrollTop(a+t))},i.on("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)}},s.prototype.scrollLockingDisable=function(){if(this.scrollLockHandler)if(this.ide){var e=this.$ide.find("> .ace_scroller > .ace_content");e.off("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)}else this.$textarea.off("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)},s.prototype.previewScrollSyncEnable=function(){if(this.previewScrollSyncDisable(),this.$previewBody.scrollTop(0),this.ide){this.ide.session.setScrollTop(0);var e=this.$previewWindow,t=this.$previewBody,s=this.$ide.find("> .ace_scrollbar-v");this.previewScrollSyncHandler=function(){var i=s.scrollTop()/(s.prop("scrollHeight")-s.outerHeight());e[0].scrollTo(0,Math.round(i*(t.prop("scrollHeight")-t.outerHeight())))}.bind(this),this.ide.session.on("changeScrollTop",this.previewScrollSyncHandler)}else{this.$textarea.scrollTop(0);var i=this.$previewWindow,n=this.$previewBody,r=this.$textarea;this.previewScrollSyncHandler=function(){var e=r.scrollTop()/(r.prop("scrollHeight")-r.outerHeight());i[0].scrollTo(0,Math.round(e*(n.prop("scrollHeight")-n.outerHeight())))}.bind(this),this.$textarea.on("scroll"+this.ens+this.ens+"-preview-scroll-sync",this.previewScrollSyncHandler)}},s.prototype.previewScrollSyncDisable=function(){this.previewScrollSyncHandler&&(this.ide?this.ide.session.removeListener("changeScrollTop",this.previewScrollSyncHandler):this.$textarea.off("scroll"+this.ens+this.ens+"-preview-scroll-sync",this.previewScrollSyncHandler))},s.prototype.automaticScrollExpand=function(e){if(!this.ide&&13===e.which&&!(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)){var s=this.$textarea.prop("selectionStart"),i=this.$textarea.prop("selectionEnd");s===i&&s>=t.trim(this.$textarea.val()).length&&this.$textarea.scrollTop(this.$textarea.prop("scrollHeight"))}},Object.defineProperty(s.prototype,"scrollbarWidth",{get:function(){if(void 0!==this._scrollbarWidth)return this._scrollbarWidth;var e=t("<div></div>");return e.css({overflow:"scroll",width:"100px",height:"100px",position:"absolute",top:"-9999px"}),this.$body.append(e),this._scrollbarWidth=e.outerWidth()-e.prop("clientWidth"),e.remove(),this._scrollbarWidth},enumerable:!0,configurable:!0}),s.prototype.log=function(){for(var e=this,s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];t.each(s,function(t,s){return console.log(e.cns+": %o",s)})},s}();e.Editor=s,e.WpMarkdownExtraEditorInstance=new s}(WpMarkdownExtraEditor||(WpMarkdownExtraEditor={}));var WpMarkdownExtraEditor;!function(e){}(WpMarkdownExtraEditor||(WpMarkdownExtraEditor={}));