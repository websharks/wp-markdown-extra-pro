"use strict";var WpMarkdownExtraEditor;!function(e){var t=jQuery,i=function(){function e(e){this.ed=e}return e.prototype.format=function(e){var i=this;if(/\[gallery\s/i.test(e))return e;if(!/<img\s.*?src=['"]([^'"]+)/i.test(e))return e;var s="";return t.each(e.split(/[\r\n]+/),function(e,t){var n,r,a,l,o,h;(n=/<img\s.*?src=['"]([^'"]+)/i.exec(t))&&(r=/<a\s.*?href=['"]([^'"]+)/i.exec(t),a=/<img\s.*?alt=['"]([^'"]+)/i.exec(t),l=/<img\s.*?class=['"]([^'"]+)/i.exec(t),o=/\[caption\s.*?align=['"]([^'"]+)/i.exec(t),h=/(?:<img|\[caption)\s.*?width=['"]([^'"]+)/i.exec(t),r&&(r[1]=r[1].replace(/^https?:\/{2}/i,"//")),n[1]=n[1].replace(/^https?:\/{2}/i,"//"),l=!l&&o?o:l,l&&/alignnone/i.test(l[1])&&(l=null),s+="\n","html"===i.ed.data.settings.mediaInserts?(r&&(s+='<a href="'+_.escape(r[1])+'">'),s+='<img src="'+_.escape(n[1])+'"',a&&(s+=' alt="'+_.escape(a[1])+'"'),l&&/alignleft/i.test(l[1])?s+=' class="alignleft"':l&&/aligncenter/i.test(l[1])?s+=' class="aligncenter"':l&&/alignright/i.test(l[1])&&(s+=' class="alignright"'),h&&(s+=' width="'+_.escape(h[1])+'"'),s+=" />",r&&(s+="</a>")):(r&&(s+="["),s+="![",a&&(s+=a[1].replace(/\[/g,"(").replace(/\]/g,")")),s+="](",s+=n[1].replace(/\(/g,"[").replace(/\)/g,"]"),s+=")",(l||h)&&(s+="{"),l&&(/alignleft/i.test(l[1])?s+=".alignleft":/aligncenter/i.test(l[1])?s+=".aligncenter":/alignright/i.test(l[1])&&(s+=".alignright")),l&&h?s+=" width="+_.escape(h[1]):h&&(s+="width="+_.escape(h[1])),(l||h)&&(s+="}"),r&&(s+="](",s+=r[1].replace(/\(/g,"[").replace(/\)/g,"]"),s+=")")))}),s+"\n"},e}();e.MediaHtml=i}(WpMarkdownExtraEditor||(WpMarkdownExtraEditor={}));var WpMarkdownExtraEditor;!function(e){var t=jQuery,i=function(){function i(){var i=this;this.data=wpMarkdownExtraEditorData,this.cns=this.data.brand.slug+"-editor",this.ens="."+this.data.brand.slug+"-editor",this.mediaHtml=new e.MediaHtml(this),this.initChain=t.Deferred().resolve().promise(),this.setupChain=t.Deferred().resolve().promise(),t(document).ready(function(){return i.onDomReady()})}return i.prototype.onDomReady=function(){this.$textarea=t("."+this.cns+"-textarea"),this.$textarea.length&&this.init()},i.prototype.init=function(){var e=this;this.initChain.then(function(){return e.initClasses()}).then(function(){return e.initElements()}).then(function(){return e.initIde()}).then(function(){return e.initPreview()}).then(function(){return e.initComplete()}).then(function(){return e.setup()})},i.prototype.initClasses=function(){this.themeClass=this.cns+"-"+this.data.settings.theme+"-theme",this.previewClass=this.cns+"-preview-mode",this.fullscreenClass=this.cns+"-fullscreen-mode",this.fullscreenPreviewClass=this.cns+"-fullscreen-preview-mode",this.fullscreenSplitPreviewClass=this.cns+"-fullscreen-split-preview-mode"},i.prototype.initElements=function(){this.$win=t(window),this.$doc=t(document),this.$html=t("html"),this.$body=t("body"),this.$head=t("head"),this.$html.addClass(this.themeClass),this.data.settings.ideEnable&&this.$html.addClass(this.cns+"-has-ide"),this.$form=this.$textarea.closest("form#post"),this.$form.addClass(this.cns+"-form"),this.$area=this.$form.find("#postdivrich"),this.$area.addClass(this.cns+"-area"),this.$wrapper=this.$area.find("#wp-content-wrap"),this.$wrapper.addClass(this.cns+"-wrapper"),this.$toolbar=this.$area.find("#wp-content-editor-tools"),this.$toolbarBtns=t('<div class="'+_.escape(this.cns+"-toolbar-btns")+'"></div>'),this.$toolbar.css({visibility:"hidden"}),this.$toolbar.find(".wp-editor-tabs").hide(),this.$toolbar.addClass(this.cns+"-toolbar").append(this.$toolbarBtns),this.$container=this.$area.find("#wp-content-editor-container"),this.$container.css({visibility:"hidden"}),this.$container.addClass(this.cns+"-container"),this.data.settings.ideEnable&&(this.$ide=t('<textarea class="'+_.escape(this.cns+"-ide")+'"></textarea>'),this.$textarea.before(this.$ide)),this.$statusInfo=this.$area.find("#post-status-info"),this.$statusInfo.css({visibility:"hidden"}),this.$statusInfo.addClass(this.cns+"-status-info"),this.$textareaResizeHandle=this.$area.find("#content-resize-handle"),this.$textareaResizeHandle.hide(),this.$preview=t('<iframe class="'+_.escape(this.cns+"-preview")+'" src="'+_.escape(this.data.settings.previewUrl)+'"></iframe>'),this.$loadingStyles=this.$area.find("."+this.cns+"-loading-styles"),this.$loading=this.$area.find("."+this.cns+"-loading")},i.prototype.initIde=function(){this.data.settings.ideEnable&&(this.ide=ace.edit(this.$ide[0]),"Infinity"===this.data.settings.ide.maxLines&&(this.data.settings.ide.maxLines=1/0),this.ide.setOptions(this.data.settings.ide),this.ide.setStyle(this.cns+"-ide"),this.ide.$blockScrolling=1/0,this.docValue(this.$textarea.val()),this.$textarea.addClass("-position-offscreen"),this.$ide=this.$container.find("."+this.cns+"-ide"))},i.prototype.initPreview=function(){var e=this,i=t.Deferred(function(i){e.$preview.on("load"+e.ens,function(){var s=e.$preview[0];e.$previewWindow=t(s.contentWindow||document.defaultView),e.$previewDocument=t(s.contentDocument||s.contentWindow.document),e.$previewHtml=e.$previewDocument.find("html"),e.$previewBody=e.$previewDocument.find("body"),e.$previewDiv=e.$previewBody.find("#md-preview-div");var n=e.$previewHtml,r=e.$previewBody;if("left"===e.data.settings.previewFrameSide){var a="";a+="."+e.cns+"-fullscreen-split-preview-mode:not(#x) ."+e.cns+"-container {",a+="   flex-direction: row-reverse;",a+="}",e.$head.append("<style>"+a+"</style>")}if(e.data.settings.previewFrameWidth){var a="";a+="@media only screen and (min-width: 1200px) {",a+="  ."+e.cns+"-fullscreen-preview-mode:not(#x) ."+e.cns+"-toolbar {",a+="    width: "+e.data.settings.previewFrameWidth+";",a+="    margin-left: calc((100% - "+e.data.settings.previewFrameWidth+") / 2);",a+="    margin-right: calc((100% - "+e.data.settings.previewFrameWidth+") / 2);",a+="  }",a+="  ."+e.cns+"-fullscreen-preview-mode:not(#x) ."+e.cns+"-preview {",a+="    flex: 1 1 "+e.data.settings.previewFrameWidth+";",a+="    margin-left: calc((100% - "+e.data.settings.previewFrameWidth+") / 2);",a+="    margin-right: calc((100% - "+e.data.settings.previewFrameWidth+") / 2);",a+="  }",a+="}",a+="."+e.cns+"-fullscreen-split-preview-mode:not(#x) ."+e.cns+"-textarea,",a+="."+e.cns+"-fullscreen-split-preview-mode:not(#x) ."+e.cns+"-ide {",a+="   flex: 1 1 calc(100% - "+e.data.settings.previewFrameWidth+");",a+="}",a+="."+e.cns+"-fullscreen-split-preview-mode:not(#x) ."+e.cns+"-preview {",a+="   flex: 1 1 "+e.data.settings.previewFrameWidth+";",a+="}",e.$head.append("<style>"+a+"</style>")}if(e.data.settings.hljsStyleUrl){var l=e.data.settings.hljsStyleUrl,o=e.data.settings.hljsStyleSri?' integrity="'+_.escape(e.data.settings.hljsStyleSri)+'" crossorigin="anonymous"':"";r.append('<link type="text/css" rel="stylesheet" href="'+_.escape(l)+'"'+o+" />")}if(e.data.settings.hljsBgColor){var h=e.data.settings.hljsBgColor;r.append("<style>.hljs-pre > .hljs { background: "+h.replace(/[<&>]/g,"")+" !important; }</style>")}if(e.data.settings.hljsFontFamily){var c=e.data.settings.hljsFontFamily;r.append("<style>.hljs-pre > .hljs { font-family: "+c.replace(/[<&>]/g,"")+" !important; }</style>")}if(e.data.settings.previewStylesUrl){var l=e.data.settings.previewStylesUrl,o=e.data.settings.previewStylesSri?' integrity="'+_.escape(e.data.settings.previewStylesSri)+'" crossorigin="anonymous"':"";r.append('<link type="text/css" rel="stylesheet" href="'+_.escape(l)+'"'+o+" />")}if(e.data.settings.customPreviewStyles){var p=e.data.settings.customPreviewStyles;r.append("<style>"+p+"</style>")}if(e.data.settings.previewTypekitId){var d=e.data.settings.previewTypekitId,u=t("<script></script>");n.addClass("wf-loading"),r.append(u),u.attr("src","//use.typekit.net/"+encodeURIComponent(d)+".js")}if(e.data.settings.customPreviewScripts){var v=e.data.settings.customPreviewScripts;r.append("<script>"+v+"</script>")}i.resolve()}),e.$container.append(e.$preview)});return i.promise()},i.prototype.initComplete=function(){this.$area.trigger("initComplete"+this.ens)},i.prototype.setup=function(){var e=this;this.setupChain.then(function(){return e.setupTextarea()}).then(function(){return e.setupIde()}).then(function(){return e.setupContainer()}).then(function(){return e.setupMediaBtn()}).then(function(){return e.setupToolbar()}).then(function(){return e.setupComplete()})},i.prototype.setupTextarea=function(){var e=this;if(!this.data.settings.ideEnable){this.scrollLockingEnable(),this.$textarea.css({"font-size":this.data.settings.fontSize,"font-family":this.data.settings.fontFamily});var t="php"===this.data.settings.previewMethod?1e3:250,i=_.debounce(function(){return e.previewRender()},t);this.$textarea.on("keyup"+this.ens,function(t){e.automaticScrollExpand(t)}),this.$textarea.on("cut"+this.ens+" paste"+this.ens+" keyup"+this.ens+" change"+this.ens,i)}},i.prototype.setupIde=function(){var e=this;if(this.data.settings.ideEnable){this.scrollLockingEnable();var i=_.debounce(function(){e.$textarea.val(e.docValue()),e.$textarea.trigger("input","ide-update"+e.ens)},1e3),s="php"===this.data.settings.previewMethod?1e3:250,n=_.debounce(function(){return e.previewRender()},s);this.ide.session.on("change",i),this.ide.session.on("change",n),this.$textarea.on("input"+this.ens,function(t,i){i!=="ide-update"+e.ens&&(e.ide.focus(),e.docValue(e.$textarea.val()))}),t("#post-preview").on("click"+this.ens,function(){return e.$textarea.val(e.docValue())}),this.$form.on("submit"+this.ens,function(){return e.$textarea.val(e.docValue())})}},i.prototype.setupContainer=function(){var e=this,i=250,s=_.debounce(function(t){return e.adjustContainer(t)},i);t(window).on("resize"+this.ens,s)},i.prototype.setupMediaBtn=function(){var e=this,t=window.send_to_editor;window.send_to_editor=function(i){return window.wpActiveEditor&&"content"!==wpActiveEditor?t(i):(i=e.mediaHtml.format(i),void(e.ide?e.ide.insert(i):t(i)))}},i.prototype.setupToolbar=function(){var e=this;this.$previewBtn=t('<button type="button" class="-preview button" title="'+_.escape(this.data.i18n.preview+" "+this.data.i18n.toggle)+'"><span class="-icon sharkicon sharkicon-eye"></span></button>'),this.$fullscreenSplitPreviewBtn=t('<button type="button" class="-fullscreen-split button" title="'+_.escape(this.data.i18n.fullscreenSplitPreview+" "+this.data.i18n.toggle)+'"><span class="-icon sharkicon sharkicon-columns"></span></button>'),this.$sitePreviewBtn=t('<button type="button" class="-post-preview button" title="'+_.escape(this.data.i18n.sitePreview)+'"><span class="-icon sharkicon sharkicon-octi-link-external"></span></button>'),this.$fullscreenBtn=t('<button type="button" class="-fullscreen button" title="'+_.escape(this.data.i18n.fullscreen+" "+this.data.i18n.toggle)+'"><span class="-icon sharkicon sharkicon-octi-screen-full"></span></button>'),this.$saveDraftBtn=t('<button type="button" class="-save-draft button" title="'+_.escape(this.data.i18n.saveDraft)+'"><span class="-icon sharkicon sharkicon-floppy-o"></span></button>'),this.$publishBtn=t('<button type="button" class="-publish button" title="'+_.escape(this.data.i18n.publish)+'"><span class="-icon sharkicon sharkicon-thumb-tack"></span></button>'),this.$updateBtn=t('<button type="button" class="-update button" title="'+_.escape(this.data.i18n.update)+'"><span class="-icon sharkicon sharkicon-thumb-tack"></span></button>'),this.$trashBtn=t('<button type="button" class="-trash button" title="'+_.escape(this.data.i18n.trash)+'"><span class="-icon sharkicon sharkicon-trash"></span></button>');var i=t("#preview-action:visible > #post-preview:visible"),s=t("#save-action:visible > #save-post:visible"),n=t("#publishing-action:visible > #publish:visible"),r=t("#delete-action:visible > a:visible");this.$toolbarBtns.append(this.$previewBtn),this.$toolbarBtns.append(this.$fullscreenSplitPreviewBtn),i.length&&this.$toolbarBtns.append(this.$sitePreviewBtn),s.length&&this.$toolbarBtns.append(this.$saveDraftBtn),n.length&&(this.data.settings.postId?this.$toolbarBtns.append(this.$updateBtn):this.$toolbarBtns.append(this.$publishBtn)),r.length&&this.$toolbarBtns.append(this.$trashBtn),this.$toolbarBtns.append(this.$fullscreenBtn),this.$previewBtn.on("click"+this.ens,function(t){switch(t.stopImmediatePropagation(),t.preventDefault(),e.currentMode){case"default":e.preparePreviewMode();break;case"preview":e.prepareDefaultMode();break;case"fullscreen":e.prepareFullscreenPreviewMode();break;case"fullscreen-preview":e.prepareFullscreenMode();break;case"fullscreen-split-preview":e.prepareFullscreenPreviewMode();break;default:e.prepareDefaultMode()}}),this.$fullscreenSplitPreviewBtn.on("click"+this.ens,function(t){switch(t.stopImmediatePropagation(),t.preventDefault(),e.currentMode){case"default":e.prepareFullscreenSplitPreviewMode();break;case"preview":e.prepareFullscreenSplitPreviewMode();break;case"fullscreen":e.prepareFullscreenSplitPreviewMode();break;case"fullscreen-preview":e.prepareFullscreenSplitPreviewMode();break;case"fullscreen-split-preview":e.prepareFullscreenMode();break;default:e.prepareDefaultMode()}}),this.$fullscreenBtn.on("click"+this.ens,function(t){switch(t.stopImmediatePropagation(),t.preventDefault(),e.currentMode){case"default":e.prepareFullscreenMode();break;case"preview":e.prepareFullscreenPreviewMode();break;case"fullscreen":e.prepareDefaultMode();break;case"fullscreen-preview":e.prepareDefaultMode();break;case"fullscreen-split-preview":e.prepareDefaultMode();break;default:e.prepareDefaultMode()}}),this.$sitePreviewBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),i.click()}),this.$saveDraftBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),s.click()}),this.$publishBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),n.click()}),this.$updateBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),n.click()}),this.$trashBtn.on("click"+this.ens,function(e){e.stopImmediatePropagation(),e.preventDefault(),location.href=r.attr("href")})},i.prototype.setupComplete=function(){var e=this;this.$loading.fadeOut(200,function(){e.$loading.remove(),e.$loadingStyles.remove(),delete e.initChain,delete e.setupChain,e.$toolbar.css({visibility:""}),e.$container.css({visibility:""}),e.$statusInfo.css({visibility:""}),e.prepareDefaultMode(),e.$area.trigger("setupComplete"+e.ens)})},i.prototype.docValue=function(e){return void 0!==e?this.ide?this.ide.setValue(e,-1):this.$textarea.val(e):e=this.ide?this.ide.getValue():this.$textarea.val(),t.trim(e.replace(/(?:\r\n|\r)/g,"\n"))},i.prototype.fullscreenBodyOverflow=function(e){e===!1?this.$body.css({overflow:"hidden",width:"calc(100% - "+this.scrollbarWidth+"px)"}):this.$body.css({overflow:"",width:""})},i.prototype.adjustContainer=function(e){if(this.currentMode.indexOf("fullscreen")!==-1){var t=this.$toolbar.outerHeight();this.$container.css({"max-height":"calc(100% - "+t+"px)"})}else this.$container.css({"max-height":""});!this.ide||e&&"resize"===e.type||this.ide.resize(!0)},i.prototype.prepareDefaultMode=function(){this.$html.removeClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.hide(),this.$saveDraftBtn.hide(),this.$publishBtn.hide(),this.$updateBtn.hide(),this.$trashBtn.hide(),this.$previewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-eye"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-normal").addClass("sharkicon-octi-screen-full"),this.currentMode="default",this.fullscreenBodyOverflow(),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender("")},i.prototype.preparePreviewMode=function(){this.$html.addClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.hide(),this.$saveDraftBtn.hide(),this.$publishBtn.hide(),this.$updateBtn.hide(),this.$trashBtn.hide(),this.$previewBtn.find(".-icon").removeClass("sharkicon-eye").addClass("sharkicon-pencil"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-normal").addClass("sharkicon-octi-screen-full"),this.currentMode="preview",this.fullscreenBodyOverflow(),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender(this.docValue())},i.prototype.prepareFullscreenPreviewMode=function(){this.$html.removeClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.addClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.show(),this.$saveDraftBtn.show(),this.$publishBtn.show(),this.$updateBtn.show(),this.$trashBtn.show(),this.$previewBtn.find(".-icon").removeClass("sharkicon-eye").addClass("sharkicon-pencil"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-full").addClass("sharkicon-octi-screen-normal"),this.currentMode="fullscreen-preview",this.fullscreenBodyOverflow(!1),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender(this.docValue())},i.prototype.prepareFullscreenSplitPreviewMode=function(){this.$html.removeClass(this.previewClass),this.$html.removeClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.addClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.show(),this.$saveDraftBtn.show(),this.$publishBtn.show(),this.$updateBtn.show(),this.$trashBtn.show(),this.$previewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-eye"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-columns").addClass("sharkicon-pencil"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-full").addClass("sharkicon-octi-screen-normal"),this.currentMode="fullscreen-split-preview",this.fullscreenBodyOverflow(!1),this.adjustContainer(),this.previewScrollSyncEnable(),this.previewRender(this.docValue())},i.prototype.prepareFullscreenMode=function(){this.$html.removeClass(this.previewClass),this.$html.addClass(this.fullscreenClass),this.$html.removeClass(this.fullscreenPreviewClass),this.$html.removeClass(this.fullscreenSplitPreviewClass),this.$sitePreviewBtn.show(),this.$saveDraftBtn.show(),this.$publishBtn.show(),this.$updateBtn.show(),this.$trashBtn.show(),this.$previewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-eye"),this.$fullscreenSplitPreviewBtn.find(".-icon").removeClass("sharkicon-pencil").addClass("sharkicon-columns"),this.$fullscreenBtn.find(".-icon").removeClass("sharkicon-octi-screen-full").addClass("sharkicon-octi-screen-normal"),this.currentMode="fullscreen",this.fullscreenBodyOverflow(!1),this.adjustContainer(),this.previewScrollSyncDisable(),this.previewRender("")},i.prototype.previewRender=function(e){var i=this;if(""===e)return this.$previewDiv.html("");if(this.$preview.is(":visible")){if(void 0===e&&(e=this.docValue()),!e)return this.$previewDiv.html("");if(this.data.settings.previewTypekitId&&!this.previewTypekitLoaded&&(this.previewTypekitLoaded=!0,this.$previewWindow[0].Typekit.load({async:!0})),"php"===this.data.settings.previewMethod)this.previewXhr&&this.previewXhr.abort(),this.previewXhr=t.ajax({type:"POST",processData:!1,data:pako.deflate(e),headers:{"content-encoding":"gzip"},contentType:"application/octet-stream",url:this.data.settings.ajaxRestActionPreviewUrl,success:function(e){var s=e.html,n=t("<div>"+s+"</div>");i.hljsInHtmlNode(n),i.$previewDiv.html(n.html())},error:function(e){return i.log("error",e)}});else{this.mdIt||(this.mdIt=markdownit({html:!0,xhtmlOut:!0,breaks:!0,linkify:!1,quotes:"“”‘’",typographer:!0,langPrefix:"lang-",highlight:this.mdItTransformHljs}).use(markdownItAttrs).use(markdownitDeflist).use(markdownitAbbr).use(markdownitFootnote),this.mdIt.renderer.rules.heading_open=function(e,t,i,s,n){var r=e[t],a=e[t+1],l=a.children.reduce(function(e,t){return e+t.content},""),o=l.toLowerCase();return o=o.replace(/[^\w]+/g,"-"),o="j2h."+o.replace(/(?:^[\s\-]+|[\s\-]+$)/g,""),r.attrs=r.attrs||[],r.attrs.push(["id",o]),n.renderToken.apply(n,arguments)},this.mdIt.renderer.rules.code_block=function(e,i,s,n,r){var a=e[i],l=t.trim(a.info||"").split(/\s+/g)[0],o=r.renderAttrs(a);return s.highlight(a.content,l,o)},this.mdIt.renderer.rules.fence=this.mdIt.renderer.rules.code_block);var s=this.mdIt.render(e);this.$previewDiv.html(s)}}},i.prototype.hljsInHtmlNode=function(e){var i=".\\!\\~hljs, .no-hljs, .no-highlight, .nohighlight",s=".lang-none, .lang-plain, .lang-text, .lang-txt, .none, .plain, .text, .txt";e.find("pre > code").not(i).each(function(e,i){var n=t(i),r=n.parent();r.addClass("hljs-pre code"),n.is(s)?n.addClass("hljs lang-none"):hljs.highlightBlock(i)})},i.prototype.mdItTransformHljs=function(e,i,s){var n=' class="hljs-pre code"',r=s||"";return i=i||"none",r=/\sclass\="([^"]*)"/i.test(r)?r.replace(/\sclass\="([^"]*)"/i,function(e,t){return' class="hljs lang-'+_.escape(i)+t+'"'}):' class="hljs lang-'+_.escape(i)+'"'+r,/\stitle\="([^"]*)"/i.test(r)&&(r=r.replace(/\stitle\="([^"]*)"/i,function(e,t){return n+=' title="'+t+'"',""})),e&&t.inArray(i,["none","plain","text","txt"])===-1&&(e=hljs.highlightAuto(e,[i]).value),"<pre"+n+"><code"+r+">"+e+"</code></pre>"},i.prototype.scrollLockingEnable=function(){var e=this;if(this.scrollLockingDisable(),this.ide){var t=this.$ide.find("> .ace_scrollbar-v"),i=this.$ide.find("> .ace_scroller > .ace_content");this.scrollLockHandler=function(i){var s=i.originalEvent.deltaY,n=s<0?"up":"down",r=t.prop("scrollHeight"),a=t.innerHeight(),l=t.scrollTop();r-a<=0||("up"===n&&l+s<=0||"down"===n&&l+s>=r-a)&&(i.preventDefault(),i.stopImmediatePropagation(),e.ide.session.setScrollTop(l+s))},i.on("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)}else{var s=this.$textarea;this.scrollLockHandler=function(e){var t=e.originalEvent.deltaY,i=t<0?"up":"down",n=s.prop("scrollHeight"),r=s.innerHeight(),a=s.scrollTop();n-r<=0||("up"===i&&a+t<=0||"down"===i&&a+t>=n-r)&&(e.preventDefault(),e.stopImmediatePropagation(),s.scrollTop(a+t))},s.on("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)}},i.prototype.scrollLockingDisable=function(){if(this.scrollLockHandler)if(this.ide){var e=this.$ide.find("> .ace_scroller > .ace_content");e.off("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)}else this.$textarea.off("wheel"+this.ens+"-scroll-lock",this.scrollLockHandler)},i.prototype.previewScrollSyncEnable=function(){if(this.previewScrollSyncDisable(),this.$previewBody.scrollTop(0),this.ide){this.ide.session.setScrollTop(0);var e=this.$previewWindow,t=this.$previewBody,i=this.$ide.find("> .ace_scrollbar-v");this.previewScrollSyncHandler=function(){var s=i.scrollTop()/(i.prop("scrollHeight")-i.outerHeight());e[0].scrollTo(0,Math.round(s*(t.prop("scrollHeight")-t.outerHeight())))}.bind(this),this.ide.session.on("changeScrollTop",this.previewScrollSyncHandler)}else{this.$textarea.scrollTop(0);var s=this.$previewWindow,n=this.$previewBody,r=this.$textarea;this.previewScrollSyncHandler=function(){var e=r.scrollTop()/(r.prop("scrollHeight")-r.outerHeight());s[0].scrollTo(0,Math.round(e*(n.prop("scrollHeight")-n.outerHeight())))}.bind(this),this.$textarea.on("scroll"+this.ens+this.ens+"-preview-scroll-sync",this.previewScrollSyncHandler)}},i.prototype.previewScrollSyncDisable=function(){this.previewScrollSyncHandler&&(this.ide?this.ide.session.removeListener("changeScrollTop",this.previewScrollSyncHandler):this.$textarea.off("scroll"+this.ens+this.ens+"-preview-scroll-sync",this.previewScrollSyncHandler))},i.prototype.automaticScrollExpand=function(e){if(!this.ide&&13===e.which&&!(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)){var i=this.$textarea.prop("selectionStart"),s=this.$textarea.prop("selectionEnd");i===s&&i>=t.trim(this.$textarea.val()).length&&this.$textarea.scrollTop(this.$textarea.prop("scrollHeight"))}},Object.defineProperty(i.prototype,"scrollbarWidth",{get:function(){if(void 0!==this._scrollbarWidth)return this._scrollbarWidth;var e=t("<div></div>");return e.css({overflow:"scroll",width:"100px",height:"100px",position:"absolute",top:"-9999px"}),this.$body.append(e),this._scrollbarWidth=e.outerWidth()-e.prop("clientWidth"),e.remove(),this._scrollbarWidth},enumerable:!0,configurable:!0}),i.prototype.log=function(){for(var e=this,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];t.each(i,function(t,i){return console.log(e.cns+": %o",i)})},i}();e.Editor=i,e.WpMarkdownExtraEditorInstance=new i}(WpMarkdownExtraEditor||(WpMarkdownExtraEditor={}));var WpMarkdownExtraEditor;!function(e){}(WpMarkdownExtraEditor||(WpMarkdownExtraEditor={}));